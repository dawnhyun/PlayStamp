<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.playstamp.playreviewdetail.mybatis.IPlayReviewDetailDAO">
	<select id="getPlayReviewDetail" resultType="com.playstamp.playreviewdetail.PlayReviewDetail" parameterType="string">
		SELECT PLAYREV_CD, RATING_CD, PLAY_IMG, TITLE, PLAYREV_DT, CONTENTS, PLAY_DT, PLAY_TIME, PLAY_NM, THEATER, PLAY_CAST, COMPANION, USER_NICK, LCOUNT, CCOUNT
		FROM VIEW_PLAYREVDETAIL
		WHERE PLAYREV_CD=#{playrev_cd}
	</select>
	
	<select id="getCommentList" resultType="com.playstamp.playreviewdetail.Comment" parameterType="string">
		SELECT COMMENT_CD, PLAYREV_CD, WR_DT, COMMENTS, USER_NICK, USER_CD
		FROM VIEW_COMMENT
		WHERE PLAYREV_CD=#{playrev_cd}
		ORDER BY WR_DT DESC
	</select>
	
	<insert id="addComment">
		INSERT INTO TBL_COMMENT(COMMENT_CD, PLAYREV_CD, USER_CD, WR_DT, COMMENTS)
		VALUES(COMMENT_SEQ.NEXTVAL, #{playrev_cd}, #{user_cd}, SYSDATE, #{comments})
	</insert>
	
	<delete id="removeComment">
		DELETE
		FROM TBL_COMMENT
		WHERE COMMENT_CD=#{comment_cd}
	</delete>
</mapper>